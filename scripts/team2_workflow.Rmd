---
title: "team2_work"
author: "Liam D. Bailey & Lena Lickteig"
date: "12/02/2021"
output: html_document
---

```{r, include = FALSE}

#Load packages
library(sf)
library(osmdata)
library(raster)
library(dplyr)
library(ggplot2)
library(here)

#Options
options(scipen = 200)

```

Load the data

```{r}

df <- read.csv2(here::here("./data/social-housing-paris/logements-sociaux-finances-a-paris.csv"),
                stringsAsFactors = FALSE) %>% 
  janitor::clean_names()

df_sf <- sf::read_sf(here::here("./data/social-housing-paris/logements-sociaux-finances-a-paris.geojson"))

```

Districts

```{r}

paris <- raster::getData(name = "GADM", country = "FRA", level = 3) %>% 
  sf::st_as_sf() %>% 
  filter(NAME_1 == "ÃŽle-de-France" & NAME_2 == "Paris")

ggplot()+
  geom_sf(data = paris) +
  geom_sf(data = df_sf)

```

Contour map

```{r}

housing_coords <- df_sf %>% 
  sf::st_coordinates() %>% 
  as_tibble()

ggplot() +
  stat_density2d_filled(data = housing_coords, aes(x = X, y = Y),
                        contour_var = "ndensity") +
  geom_sf(data = paris, fill = NA, colour = "black", size = 1, alpha = 0.75) +
  scale_fill_viridis_d(name = "Relative housing density",
                      labels = c("0-0.1", "0.1-0.2", "0.2-0.3", "0.3-0.4",
                                 "0.4-0.5", "0.5-0.6", "0.6-0.7", "0.7-0.8",
                                 "0.8-0.9", "0.9-1.0")) +
  theme(panel.background = element_rect(fill = "#440154FF"),
        panel.grid = element_blank())

```